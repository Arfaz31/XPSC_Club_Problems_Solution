#include <bits/stdc++.h>
using namespace std;

int main()
{
    ios::sync_with_stdio(false);
    cin.tie(nullptr);

    int t;
    cin >> t;
    while (t--)
    {
        int n;
        cin >> n;

        vector<long long> a(n + 1);
        for (int i = 1; i <= n; i++)
            cin >> a[i];

        string s;
        cin >> s;
        s = "#" + s; // 1-based indexing ‡¶∏‡¶π‡¶ú ‡¶ï‡¶∞‡¶æ‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø

        // prefix sum (‡¶Ø‡¶æ‡¶§‡ßá ‡¶¶‡ßç‡¶∞‡ßÅ‡¶§ range sum ‡¶™‡¶æ‡¶ì‡ßü‡¶æ ‡¶Ø‡¶æ‡ßü)
        vector<long long> pref(n + 1, 0);
        for (int i = 1; i <= n; i++)
            pref[i] = pref[i - 1] + a[i];

        long long ans = 0;
        int l = 1, r = n;

        while (l < r)
        {
            // find first L from left
            while (l <= n && s[l] != 'L')
                l++;
            // find first R from right
            while (r >= 1 && s[r] != 'R')
                r--;

            if (l < r)
            {
                // ‡¶Ü‡¶Æ‡¶∞‡¶æ ‡¶è‡¶ï‡¶ü‡¶æ valid pair ‡¶™‡ßá‡¶≤‡¶æ‡¶Æ (L...R)
                ans += pref[r] - pref[l - 1]; // range sum- prefix sum ‡¶∂‡ßÅ‡¶∞‡ßÅ ‡¶•‡ßá‡¶ï‡ßá ‡¶∏‡¶¨ ‡¶Ø‡ßã‡¶ó ‡¶ï‡¶∞‡¶õ‡ßá ‚Äî ‡¶§‡¶æ‡¶á l-‡¶è‡¶∞ ‡¶Ü‡¶ó‡ßá‡¶∞ ‡¶∏‡¶¨ ‡¶¨‡¶æ‡¶¶ ‡¶¶‡¶ø‡¶§‡ßá ‡¶π‡¶≤‡ßá l - 1 ‡¶™‡¶∞‡ßç‡¶Ø‡¶®‡ßç‡¶§ ‡¶Ö‡¶Ç‡¶∂‡¶ü‡¶æ subtract ‡¶ï‡¶∞‡¶§‡ßá ‡¶π‡ßü‡•§
                l++;
                r--;
            }
        }

        cout << ans << "\n";
    }
    return 0;
}

// üîπ ‡¶∏‡¶Ç‡¶ï‡ßç‡¶∑‡ßá‡¶™‡ßá ‡¶¨‡¶≤‡¶§‡ßá ‡¶ó‡ßá‡¶≤‡ßá:

// ‡¶§‡ßÅ‡¶Æ‡¶ø ‡¶Ø‡¶§ ‡¶¨‡ßá‡¶∂‡¶ø ‡¶∏‡¶Æ‡ßç‡¶≠‡¶¨ 'L' ‡¶è‡¶∞ ‡¶¨‡¶æ‡¶Æ‡ßá ‡¶è‡¶¨‡¶Ç 'R' ‡¶è‡¶∞ ‡¶°‡¶æ‡¶®‡ßá ‡¶ú‡ßã‡ßú‡¶æ ‡¶¨‡¶æ‡¶®‡¶æ‡¶§‡ßá ‡¶™‡¶æ‡¶∞‡ßã,
// ‡¶Ü‡¶∞ ‡¶™‡ßç‡¶∞‡¶§‡¶ø‡¶¨‡¶æ‡¶∞ ‡¶§‡¶æ‡¶¶‡ßá‡¶∞ ‡¶Æ‡¶æ‡¶ù‡ßá ‡¶•‡¶æ‡¶ï‡¶æ ‡¶∏‡¶¨ ‡¶∏‡¶Ç‡¶ñ‡ßç‡¶Ø‡¶æ‡¶∞ ‡¶Ø‡ßã‡¶ó‡¶´‡¶≤ ‡¶∏‡ßç‡¶ï‡ßã‡¶∞‡ßá ‡¶Ø‡ßã‡¶ó ‡¶ï‡¶∞‡¶¨‡ßá‡•§

// ‡¶≤‡¶ï‡ßç‡¶∑‡ßç‡¶Ø ‚Äî ‡¶è‡¶á ‡¶Ø‡ßã‡¶ó‡¶´‡¶≤‡¶ü‡¶æ‡¶ï‡ßá maximized ‡¶ï‡¶∞‡¶æ‡•§